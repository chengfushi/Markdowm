Java 字符串是编程中的核心内容，掌握其特性和使用场景能极大提升代码效率。以下是对 Java 字符串的详细解析：

---

### 一、String 类概述与不可变性
1. **不可变性**  
   String 对象一旦创建，内容不可修改。所有看似“修改”的操作（如拼接、替换）都会生成新对象。
   • **原因**：安全性（如作为参数传递）、线程安全、哈希值缓存（如 HashMap 键）、类加载机制依赖。
   • **底层实现**：
     ◦ Java 8 及以前：`private final char[] value;`
     ◦ Java 9+：`private final byte[] value;` （针对 Latin-1 字符优化为单字节存储）

2. **创建方式**
   ```java
   String s1 = "abc";             // 方式1：字面量，直接存入字符串常量池
   String s2 = new String("abc"); // 方式2：通过new，在堆中创建新对象
   ```

---

### 二、字符串常量池（String Pool）
1. **位置与作用**
   • **Java 7 前**：位于方法区（永久代）。
   • **Java 7+**：移至堆内存，避免永久代内存溢出。
   • **作用**：缓存字符串字面量，避免重复创建。

2. **intern () 方法**
   • 若字符串不在常量池中，将其添加并返回引用；否则直接返回池中引用。
   ```java
   String s3 = new String("abc").intern(); // s3指向常量池中的"abc"
   ```

---

### 三、字符串比较
• **`==`**：比较对象内存地址。
• **`equals()`**：比较内容是否相同。
   ```java
   String a = "hello";
   String b = new String("hello");
   System.out.println(a == b);          // false
   System.out.println(a.equals(b));     // true
   ```

---

### 四、常用方法
| 方法类别 | 示例方法 | 说明 |
|----------|----------|------|
| **查询** | `length()`, `charAt(int)` | 获取长度、指定位置字符 |
| **比较** | `equals()`, `compareTo()` | 内容比较、字典序比较 |
| **截取** | `substring(int, int)` | 按索引截取子串 |
| **查找** | `indexOf()`, `contains()` | 查找字符/子串位置 |
| **替换** | `replace()`, `replaceAll()` | 替换字符/正则匹配内容 |
| **分割** | `split(String)` | 按正则分割为数组 |
| **转换** | `toUpperCase()`, `trim()` | 转大小写、去空格 |

---

### 五、字符串拼接与性能
1. **`+` 操作符**  
   编译后底层使用 `StringBuilder`，但循环中反复拼接会生成多个临时对象，导致性能问题。
   ```java
   // 反例：每次循环创建新StringBuilder
   String s = "";
   for (int i = 0; i < 100; i++) {
       s += i; // 避免在循环中用+拼接！
   }
   
   // 正例：显式使用StringBuilder
   StringBuilder sb = new StringBuilder();
   for (int i = 0; i < 100; i++) {
       sb.append(i);
   }
   String result = sb.toString();
   ```

2. **高效工具**  
   • `StringBuilder`：单线程环境使用（非线程安全，性能高）。
   • `StringBuffer`：多线程环境使用（线程安全，方法用 `synchronized` 修饰）。
   • `StringJoiner`：Java 8+，支持分隔符、前缀后缀。
     ```java
     StringJoiner joiner = new StringJoiner(", ", "[", "]");
     joiner.add("A").add("B"); // 结果：[A, B]
     ```

---

### 六、其他重要知识点
1. **编码与转换**  
   • `byte[] bytes = str.getBytes(StandardCharsets.UTF_8);`
   • `String s = new String(bytes, "UTF-8");`

2. **格式化字符串**  
   ```java
   String formatted = String.format("Name: %s, Age: %d", "Alice", 30);
   ```

3. **正则表达式**  
   ```java
   boolean isMatch = "123".matches("\\d+"); // 检查是否为数字
   String[] parts = "a,b,c".split(",");     // 分割为数组
   ```

---

### 七、最佳实践
1. **优先使用字面量创建字符串**，减少内存开销。
2. **避免在循环中使用 `+` 拼接**，改用 `StringBuilder`。
3. **注意 `equals` 和 `==` 的区别**，尤其是比较用户输入或动态生成的字符串时。
4. **利用字符串常量池**，适当使用 `intern()` 方法优化内存（需权衡性能）。

---
